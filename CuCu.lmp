#LAMMPS Simulation for Ideal Cu-Cu Diffusion

#Initialization
units       metal
dimension   3
boundary    p   p   p
atom_style  atomic

#System Properties
reset_timestep 0
timestep 0.005
variable latparam equal 3.61
variable boxLength equal 20.0
variable temperature equal 600

#Create simulation box
lattice fcc ${latparam}
region simBox block 0 ${boxLength} 0 ${boxLength} 0 12.5
create_box 1 simBox
region lowerSlab block 0 ${boxLength} 0 ${boxLength} 0 5.0
region upperSlab block 0 ${boxLength} 0 ${boxLength} 7.5 ${boxLength}
create_atoms 1 region lowerSlab
create_atoms 1 region upperSlab
group lowerSlab type 1
group upperSlab type 2

#Potential
pair_style meam
pair_coeff * * library.meam Cu Cu.meam Cu

#Settings
compute csym all centro/atom fcc
compute peratom all pe/atom 
compute virial all stress/atom NULL

#EQUILIBRATION
reset_timestep 0
timestep 0.005
velocity all create 300 12345
fix 1 all npt temp 573 573 0.5 iso 0 0 5 drag 1 
thermo 400
thermo_style custom step lx ly lz press pxx pyy pzz pe temp

# Use custom dump for Ovito output
dump 1 all custom 250 dump.Cu.equil.* id x y z c_peratom fx fy fz c_virial[1] c_virial[2] c_virial[3] c_virial[4] c_virial[5] c_virial[6]
run 4000
unfix 1
undump 1

variable tmp equal "lz"
variable L0 equal ${tmp}
print "Initial Length, L0: ${L0}"

# DEFORMATION
reset_timestep 0

fix 1 all npt temp 573 573 0.5 y 0 0 5 x 0 0 5 drag 1
fix 2 all deform 1 z erate -0.01

# Output strain and stress info to file
# for units metal, pressure is in [bars] = 100 [kPa] = 1/10000 [GPa]
# p2, p3, p4 are in GPa
variable strain equal "(lz - v_L0)/v_L0"
variable p1 equal "v_strain"
variable p2 equal "-pxx/10000"
variable p3 equal "-pyy/10000"
variable p4 equal "-pzz/10000"
fix def1 all print 100 "${p1} ${p2} ${p3} ${p4}" file Cu_comp_300.1e10.dat screen no

# Use custom dump for Ovito output
dump 2 all custom 250 dump.Cu.comp.* id xs ys zs c_csym c_peratom fx fy fz c_virial[1] c_virial[2] c_virial[3] c_virial[4] c_virial[5] c_virial[6]

# Display thermo, run for 20 ps
thermo 400
thermo_style custom step v_strain temp v_p2 v_p3 v_p4 ke pe press

run 4000

# SIMULATION DONE
print "All done"
